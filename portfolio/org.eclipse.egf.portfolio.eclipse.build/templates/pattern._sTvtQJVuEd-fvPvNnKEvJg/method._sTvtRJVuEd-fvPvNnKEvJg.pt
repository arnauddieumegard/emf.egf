<%String stepName = new GenerationHelper().getPositionString(buildStep);%>
    <target name="<%=stepName%>" depends="<%=new GenerationHelper().getCleanTypeString("", ",", buildStep.getCleanBeforeBuild())%>init,install.buckminster">
        <echo message="Importing projects into workspace ${workspace} and binaries into target platform" />

    	<buckminster command="installJRE">
            <cmdargs>
                <arg value="--location" />
                <arg value="${env.JAVA_HOME}" />
            </cmdargs>
        </buckminster>

        <buckminster command="importtargetdefinition">
            <cmdargs>
                <arg value="--active" />
                <arg value="${basedir}/buckminster_<%=stepName%>/build.target" />
            </cmdargs>
        </buckminster>
    	
        <buckminster command="import">
            <!-- Uncomment to debug <globargs><jvmarg value="-agentlib:jdwp=transport=dt_socket,address=8000,server=y,suspend=y"/></globargs> -->
            <cmdargs>
                <arg value="-P" />
                <arg value="${basedir}/build.properties" />
                <arg value="${basedir}/buckminster_<%=stepName%>/build.mspec" />
            </cmdargs>
        </buckminster>

        <echo message="Invoking all eclipse builders on workspace ${workspace}" />
        <buckminster command="build" >
            <cmdargs>
                <arg value="--clean" />
                <arg value="--thorough" />
            </cmdargs>
		</buckminster>
    </target>

